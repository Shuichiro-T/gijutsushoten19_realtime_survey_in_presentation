# 画面一覧

本システムの画面構成について、画面名称、対象ユーザ、使用用途を記載します。

## プレゼンター用画面

### イベント管理画面 (EventManagement)
- **対象ユーザ**: プレゼンター
- **使用用途**: イベントとアンケートの一元管理
- **アクセス方法**: 
  - イベント作成後の自動遷移
  - `/events/{eventId}` による直接アクセス（Issue #91対応）
- **主な機能**:
  - **パスパラメータ対応イベント管理** (Issue #91対応)
    - URLパスパラメータからイベントIDを取得
    - 既存イベントへの再アクセス機能
    - イベント情報の動的表示
  - **作成済みアンケート一覧表示機能** (Issue #91対応)
    - `/api/surveys/events/{eventId}/surveys` からアンケート一覧を取得
    - アンケートタイトル、質問、作成日時の表示
    - リアルタイムでのアンケートデータ更新
  - **アンケート回答用QRコード・URL表示機能** (Issue #91対応)
    - アンケートクリック時のモーダル表示
    - アンケート回答URLの自動生成とクリップボードコピー
    - QRコード表示エリア（実装予定）
    - レスポンシブ対応モーダルデザイン
  - イベント作成・管理機能
  - アンケート作成・編集機能
  - **プレゼンテーション画面への直接遷移機能** (Issue #93対応)
    - スライドURL入力フィールド
    - イベント管理画面から直接プレゼンテーション画面への遷移
    - 従来のプレゼンテーション設定画面をバイパスした効率的なワークフロー
- **技術仕様**:
  - React Router v6のuseParamsフックによるパラメータ取得
  - useEffectによるデータ自動取得
  - エラーハンドリングとローディング状態管理
  - モーダルUIによるユーザビリティ向上
  - CSS Grid・Flexboxによるレスポンシブデザイン

### イベント登録画面 (EventRegistration)
- **対象ユーザ**: プレゼンター
- **使用用途**: 新規イベントの登録
- **主な機能**:
  - イベント基本情報の入力
  - イベントIDの自動生成
  - バリデーション機能

### アンケート作成画面 (SurveyCreation)
- **対象ユーザ**: プレゼンター
- **使用用途**: アンケート問題の作成・編集・管理
- **主な機能**:
  - アンケートタイトル・質問文の入力
  - 選択肢の追加・編集・削除
  - 選択肢の並び順調整
  - アンケートの保存・更新
  - **アンケート作成成功時のQRコード・URL表示機能** (v2.3対応)
    - アンケート回答用URLの自動生成とクリップボードコピー機能
    - QR Server APIを使用したQRコード自動生成・表示
    - プレゼンテーション時の参加者向け案内情報提供
    - モバイル対応レスポンシブデザイン
- **技術仕様**:
  - React State管理による画面状態制御
  - QR Server API (https://api.qrserver.com) による外部QRコード生成
  - Clipboard APIによるURL自動コピー機能
  - CSS Grid・Flexboxレイアウトによるレスポンシブ対応

### プレゼンテーション画面
- **対象ユーザ**: プレゼンター
- **使用用途**: プレゼンテーション資料の表示とアンケート結果のリアルタイム表示
- **主な機能**:
  - スライド表示（Google Slides埋め込み）
  - 全画面表示対応
  - **アンケート結果のリアルタイム表示** (v2.2対応)
    - **イベントIDベースのアンケート自動取得機能**
      - `/api/surveys/events/{eventId}/surveys` エンドポイントからアンケート一覧を取得
      - イベントに紐づく全アンケートの自動読み込み
      - アンケートID、タイトル、質問内容の動的表示
    - **取得したアンケートIDでのリアルタイム結果表示**
      - `/api/surveys/events/{eventId}/surveys/{surveyId}/results` エンドポイントでアンケート結果取得
      - 複数アンケート間のナビゲーション機能
      - 選択肢別の回答数とパーセンテージ表示
      - プログレスバーによる視覚的な結果表示
      - 5秒間隔での自動更新
    - リアルタイムアンケート結果の表示・非表示切り替え
  - キーボードショートカット（Esc: 終了、F11: 全画面、S: アンケート結果表示切り替え、←→: アンケート切り替え）
- **技術仕様**:
  - React Hooksによる状態管理
  - RESTful API通信による動的データ取得
  - リアルタイムAPIポーリング（5秒間隔）
  - CSS3アニメーションによるスムーズなUI遷移
  - レスポンシブデザイン対応
  - アクセシビリティ対応（キーボードナビゲーション）
- **データフロー** (v2.2更新):
  1. propsでeventIdを受け取り
  2. `/api/surveys/events/{eventId}/surveys` からアンケート一覧を取得
  3. 取得したアンケートIDを使用して結果を定期取得
  4. リアルタイムでアンケート結果をプレゼンテーション画面に表示

## 観客用画面

### アンケート回答画面 (SurveyResponse)
- **対象ユーザ**: 観客
- **使用用途**: リアルタイムアンケートへの回答
- **アクセス方法**: `/events/{eventId}/surveys/{surveyId}` でURL直接アクセス
- **対応デバイス**: スマートフォン対応（レスポンシブデザイン）
- **主な機能**:
  - パスパラメータによるイベントID・アンケートID取得
  - **動的アンケート読み込み機能** (v2.0対応)
    - バックエンドAPIからリアルタイムでアンケート情報を取得
    - `/api/surveys/events/{eventId}/surveys/{surveyId}` エンドポイントを使用
    - 事前にテーブルに格納されたアンケートデータの動的表示
  - 選択肢アンケートへの対応 (現在は単一選択のみ)
    - 複数選択（ラジオボタン）
    - データベースから取得した選択肢の動的表示
  - 必須項目バリデーション機能
  - リアルタイム入力検証
  - 回答送信とローディング状態表示
    - `/api/surveys/responses` エンドポイントへの送信
    - 選択肢IDベースでの回答保存
  - エラーハンドリング（アンケート未存在・終了済み・送信エラー）
  - 送信完了画面の表示
- **技術仕様**:
  - React Router v6によるルーティング
  - TypeScriptによる型安全性
  - CSS-in-JSによるスタイリング
  - モバイルファーストレスポンシブデザイン
  - Fetch APIを使用したRESTful API通信
- **データフロー**:
  1. URL パラメータからeventId・surveyIdを抽出
  2. バックエンドAPIからアンケート情報を取得
  3. 取得したデータを内部Survey型に変換して表示
  4. ユーザーの回答を収集・バリデーション
  5. 選択肢IDと共にバックエンドに回答を送信

## 画面間のナビゲーション構成

### 実装済み画面の関係性
- **メイン画面**: EventManagement（イベント管理）
- **サブ画面**: EventRegistration, SurveyCreation, PresentationScreen, SurveyResponse
- **画面遷移**: React Router v6 によるSPA形式のナビゲーション

### 現在未実装の画面
- プレゼンテーション閲覧画面（観客用）
- システム管理画面（管理者用）
- ログイン画面（認証機能）
- エラー画面（統一エラーハンドリング）

### 今後の拡張予定
システムの成熟度に応じて、管理者用画面や認証機能を段階的に追加予定。